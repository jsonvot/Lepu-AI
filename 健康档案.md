# 健康档案

> **本文档仅提供给服务对接方使用，未经允许不得对外发布**

<!-- TOC -->

- [第三方数据处理接口](#第三方数据处理接口)
    - [版本修订记录](#版本修订记录)
    - [1. 请求信息](#1-请求信息)
    - [2. 接口信息](#2-接口信息)
        - [2.1 获取用户授权url](#21-获取用户授权url)
        - [3.1 用户取消授权](#31-用户取消授权)
    - [附录](#附录)
        - [用户授权/用户取消授权推送消息](#用户授权/用户取消授权推送消息)

<!-- /TOC -->



## 版本修订记录

| 时间           | 版本 | 修改人 | 修改说明 |
| -------------- | ---- | ------ | -------- |
| 2022年12月22日 | v0.1 | k   | 初次发布 |
| 2022年12月29日 | v0.2 | k   | 新增接口 |


## 1. 请求信息

1. 接口地址

   测试Host: `https://open.viatomtech.com.cn`

2. 接口基本定义
   本文档中的业务接口的入（出）参均是指业务参数，调用接口时Headers必须添加上公共请求头，解析响应时，必须按照公共出参解析

3. 字符编码
   UTF-8

4. 公共请求头 - Header

   | 参数名        | 是否必须     | 类型（长度） | 说明                                     |
   | ------------ | ----------- | ------------ | ------------------------------------- |
   | secret       | 是          | string       | 乐普给出                                |
   | access-token | 是       | string       | 乐普给出, 不同业务使用不同的access_token      |
   | language     | 是       | string       | zh-CN  / en-US                            |

5. 公共出参

   | 参数名  | 是否必须 | 类型（长度） | 说明                                 |
   | ------- | -------- | ------------ | ------------------------------------ |
   | code    | 是       | int          | 响应码， 0：成功，其他：异常          |
   | message | 是       | string       | 响应描述（常用于出错后的提示）       |
   | reason  | 是       | string       | 错误详情（主要为出错后的堆栈信息）   |
   | data    | 是       | 无限制       | 响应内容（请参考具体业务接口的出参） |

## 2. 接口信息

### 2.1 获取用户授权url

&emsp;&emsp;接口地址：POST&emsp;`${host}/api/v1/open/auth/jump_path` \
&emsp;&emsp;Content-Type:&emsp;&emsp; `application/json`

 **请求体**

不传或者为空请求体皆可



 
 **响应参数**

 | 参数名       | 是否必须  | 类型（长度）  | 说明                   |
 | ----------- | -------- | ------------| --------------------- |
 | code        | 是       | int         | 响应码    |
 | data        | 是       | objecg      | 响应数据  |
 | message     | 是       | string      | 响应描述  |
 | reason      | 是       | string      | 错误详情  |

例：
    
```jsonc
{
	"code": 0,
	"data": {
		"jump_path": "https://xxxx.com.cn/auth/#/?sign=SoR8T6T9zhecSR1qw=="
	},
	"message": "请求成功",
	"reason": ""
}
```

### 3.1 用户取消授权

&emsp;&emsp;接口地址：POST&emsp;`${host}/api/v1/open/auth/cancel` \
&emsp;&emsp;Content-Type:&emsp;&emsp; `application/json`

 **请求体**

 | 参数名       | 是否必须 | 类型（长度） | 说明                         |
 | ------------| -------- | ------------ | ------------------------ |
 | phone    | 是       | string    | 取消授权用户手机号                       |


 **响应参数**

 | 参数名       | 是否必须  | 类型（长度）  | 说明                   |
 | ----------- | -------- | ------------| --------------------- |
 | code        | 是       | int         | 响应码    |
 | data        | 是       | objecg      | 响应数据  |
 | message     | 是       | string      | 响应描述  |
 | reason      | 是       | string      | 错误详情  |

例：
    
```jsonc
{
	"code": 0,
	"data": {},
	"message": "请求成功",
	"reason": ""
}
```


## 附录

### 用户授权/用户取消授权推送消息

```jsonc
//用户授权
{
    "type": 2,
    "data_tag": "7a4569155dc60bcb36189490bf90dcfc", //数据唯一标识
    "account_id": "OA==|MTEx",
    "member_id": "OA==|LTE=",
    "device_sn": "",
    "data": {
        "phone": "153xxxxxxxx" //授权用户手机号
    },
    "user_info": {},
    "create_time": "2022-12-29 16:33:40",
    "update_time": "2022-12-29 16:33:40"
}
//用户取消授权
{
    "type": 3,
    "data_tag": "a4569155dc60bcb36189490bf90dcfca",//数据唯一标识
    "account_id": "OA==|MTEx",
    "member_id": "OA==|LTE=",
    "device_sn": "",
    "data": {
        "phone": "153xxxxxxxx" //取消授权用户手机号
    },
    "user_info": {},
    "create_time": "2022-12-29 16:33:40",
    "update_time": "2022-12-29 16:33:40"
}
```